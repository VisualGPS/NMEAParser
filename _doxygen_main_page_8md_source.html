<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NMEAParser: D:/Source/GitHub/NMEAParser/Software/NMEAParserLib/DoxygenMainPage.md Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NMEAParser
   </div>
   <div id="projectbrief">NMEA Parser Library - Monte Variakojis @VisualGPS</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">D:/Source/GitHub/NMEAParser/Software/NMEAParserLib/DoxygenMainPage.md</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_doxygen_main_page_8md.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;\mainpage NMEAParser Library</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;# NMEA Parser Class Library</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Monte Variakojis \@VisualGPS</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;## Introduction</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;The NMEA 0813 standard for interfacing marine electronics devices specifies the NMEA data sentence structure as well as general definitions of approved sentences. However, the specification does not cover implementation and design. This article will hopefully clarify some of the design tasks needed to parse through NMEA sentences robustly. It will try to show techniques in parsing and data integrity checking. The article does assume that the reader has knowledge in software design and has experience in some sort of programming language. This article will reference the NMEA 0183 specification and it is recommended that the NMEA 0813 specification be available as a reference.</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;This article makes no assumption of the media that the NMEA data is acquired. The techniques here can be applied on received data from a higher abstraction layer. A simple example written in C++ demonstrates this parser design. Please note that the specific NMEA sentences parsed are centric to a GPS device.</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;## NMEA Protocol</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;NMEA data is sent in 8-bit ASCII where the MSB is set to zero (0). The specification also has a set of reserved characters. These characters assist in the formatting of the NMEA data string. The specification also states valid characters and gives a table of these characters ranging from HEX 20 to HEX 7E.</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;As stated in the NMEA 0183 specification version 3.01 the maximum number of characters shall be 82, consisting of a maximum of 79 characters between start of message &quot;$&quot; or &quot;!&quot; and terminating delimiter &lt;CR&gt;&lt;LF&gt; (HEX 0D and 0A). The minimum number of fields is one (1).</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;### Basic sentence format:</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;````</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    $aaccc,c--c*hh&lt;CR&gt;&lt;LF&gt;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        $           Start of sentence</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        aaccc       Address field/Command</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        ,          Field delimiter (Hex 2C)</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        c--c        Data sentence block</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        *           Checksum delimiter (HEX 2A)</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        hh          Checksum field (the hexadecimal value represented in ASCII)</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        &lt;CR&gt;&lt;LF&gt;    End of sentence (HEX OD OA)</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;````</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;### NMEA Parser</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;Most protocols have a state machine tracking the protocol state and any errors that may occur during the data transfer. The NMEA parser we are discussing is based on a simple state machine. By using a state machine the computer can easily keep track of where it is within the protocol as well as recover from any errors such as timeouts and checksum errors.</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;The parsing example is designed such that a buffer can be sent to the parser along with the buffer length to maximize the computer processor efficiency. This will allow the computer to parse data when it is received. Since NMEA data is typically sent at 4800 baud, computers are often waiting for data. By having a state machine in place, partial or complete sets of NMEA data may be parsed. If only a partial set of data was received and sent to the parser, then when the rest of the data is received, the parser will complete any NMEA sentence that may have been incomplete.</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;Below, Figure 1 illustrates the data flow to the NMEA parser. Our design will assume two abstract software layers, NMEA protocol parser and specific NMEA sentence parser. It does not matter the number of data bytes received or if there is only a partial message. The NMEA parser will manage the data and extract individual NMEA sentences.</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;\dot [ figure 1 ]</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   digraph data_flow{</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;       node[fontname = Helvetica, fontsize = 10];</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;       edge[fontname = Helvetica, fontsize = 10];</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;       RECEIVE_DATA[label = &quot;Data Received&quot; shape=&quot;rectangle&quot;];</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;       SEND_RAW_DATA[label = &quot;Send raw data to NMEA Parser&quot; shape=&quot;rectangle&quot;];</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;       PROCESSED_ALL_DATA[label = &quot;Processed All\nData?&quot; shape=&quot;diamond&quot;];</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;       SENTENCE_FOUND[label = &quot;NMEA sentence\nfound?&quot; shape=&quot;diamond&quot;];</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;       PROCESS_SENTENSE[label = &quot;Process Sentence&quot; shape=&quot;rectangle&quot;];</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;       DONE[label = &quot;Done&quot; shape=&quot;rectangle&quot;];</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;       RECEIVE_DATA-&gt;PROCESSED_ALL_DATA[arrowhead = &quot;normal&quot;, style = &quot;solid&quot;];</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;       PROCESSED_ALL_DATA-&gt;SEND_RAW_DATA[arrowhead = &quot;normal&quot;, style = &quot;solid&quot;, label=&quot;No&quot;, tailport=s];</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;       PROCESSED_ALL_DATA-&gt;DONE[arrowhead = &quot;normal&quot;, style = &quot;solid&quot;, label=&quot;Yes&quot;, tailport=e];</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;       SEND_RAW_DATA-&gt;SENTENCE_FOUND[arrowhead = &quot;normal&quot;, style = &quot;solid&quot;, headport=n];</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;       SENTENCE_FOUND-&gt;PROCESSED_ALL_DATA[arrowhead = &quot;normal&quot;, style = &quot;solid&quot;, label=&quot;No&quot;, tailport=w, headport=w];</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;       SENTENCE_FOUND-&gt;PROCESS_SENTENSE[arrowhead = &quot;normal&quot;, style = &quot;solid&quot;, label=&quot;Yes&quot;, tailport=s];</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;       PROCESS_SENTENSE-&gt;PROCESSED_ALL_DATA[arrowhead = &quot;normal&quot;, style = &quot;solid&quot;, tailport=w, headport=w];</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;}</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;\enddot</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;## How it Works</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;The NMEAParser class is composed of two main classes and individual NMEA sentence classes.</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;\dot Figure 2 - Class Hierarchy</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   digraph packet_state_machine {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;       node[fontname = Helvetica, fontsize = 10];</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;       edge[fontname = Helvetica, fontsize = 10];</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;       CNMEAParser[label = &quot;CNMEAParser&quot; shape=&quot;rectangle&quot; URL = &quot;\ref CNMEAParser&quot;];</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;       CNMEAParserPacket[label = &quot;CNMEAParserPacket&quot; shape=&quot;rectangle&quot; URL = &quot;\ref CNMEAParserPacket&quot;];</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;       CNMEAParserPacket-&gt;CNMEAParser[arrowhead = &quot;normal&quot;, dir=&quot;back&quot;, style = &quot;solid&quot;];</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   }</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;\enddot</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;The CNMEAParserPacket does the work of parsing the actual packet from a buffer of data. The data is feed into the state machine using the CNMEAParserPacket::ProcessNMEABuffer() method. This method will parse through the data, verify the checksum (if present) and call the virtual method CNMEAParserPacket::ProcessRxCommand(). The CNMEAParser class is based from the CNMEAParserPacket, redefines the ProcessRxCommand() method, and actual parse the specific NMEA sentence.</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;## Packet Parser State Machine - CNMEAParserPacket::ProcessNMEABuffer()</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;Located in the CNMEAParserPacket::ProcessNMEABuffer() method, the state machine will parse the incoming buffer weather itâ€™s one byte or contains multiple NMEA sentences. Below describes the packet parsing states for a NMEA sentence.</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;\dot Receive Packet State Machine</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   digraph packet_state_machine{</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;       node[fontname = Helvetica, fontsize = 10];</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;       edge[fontname = Helvetica, fontsize = 10];</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;       PARSE_STATE_SOM[label = &quot;1\nPARSE_STATE_SOM&quot; URL = &quot;\ref CNMEAParserPacket::PARSE_STATE&quot;];</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;       PARSE_STATE_CMD[label = &quot;2\nPARSE_STATE_CMD&quot; URL = &quot;\ref CNMEAParserPacket::PARSE_STATE&quot;];</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;       PARSE_STATE_DATA[label = &quot;3\nPARSE_STATE_DATA&quot; URL = &quot;\ref CNMEAParserPacket::PARSE_STATE&quot;];</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;       PARSE_STATE_CHECKSUM_1[label = &quot;4\nPARSE_STATE_CHECKSUM_1&quot; URL = &quot;\ref CNMEAParserPacket::PARSE_STATE&quot;];</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;       PARSE_STATE_CHECKSUM_2[label = &quot;5\nPARSE_STATE_CHECKSUM_2&quot; URL = &quot;\ref CNMEAParserPacket::PARSE_STATE&quot;];</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;       ProcessRxCommand[label = &quot;Call Virtual ProcessRxCommand&quot; shape=&quot;rectangle&quot; URL = &quot;\ref CNMEAParserPacket::ProcessRxCommand&quot;];</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;       PARSE_STATE_SOM-&gt;PARSE_STATE_CMD[arrowhead = &quot;normal&quot;, style = &quot;solid&quot;];</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;       PARSE_STATE_CMD-&gt;PARSE_STATE_DATA[arrowhead = &quot;normal&quot;, style = &quot;solid&quot;];</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;       PARSE_STATE_DATA-&gt;PARSE_STATE_CHECKSUM_1[arrowhead = &quot;normal&quot;, style = &quot;solid&quot;];</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;       PARSE_STATE_DATA-&gt;PARSE_STATE_SOM[arrowhead = &quot;normal&quot;, style = &quot;solid&quot;, color = red, label=&quot;Checksum\nMismatch&quot;];</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;       PARSE_STATE_DATA-&gt;ProcessRxCommand [arrowhead = &quot;normal&quot;, style = &quot;solid&quot;, label=&quot;Sentence With\nNo Checksum&quot;];</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;       PARSE_STATE_DATA-&gt;PARSE_STATE_SOM[arrowhead = &quot;normal&quot;, style = &quot;solid&quot;, color = red, label=&quot;Buffer\nOverflow&quot;];</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;       PARSE_STATE_CHECKSUM_1-&gt;PARSE_STATE_CHECKSUM_2[arrowhead = &quot;normal&quot;, style = &quot;solid&quot;];</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;       PARSE_STATE_CHECKSUM_2-&gt;ProcessRxCommand [arrowhead = &quot;normal&quot;, style = &quot;solid&quot;];</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;       PARSE_STATE_CHECKSUM_2-&gt;PARSE_STATE_SOM [arrowhead = &quot;normal&quot;, style = &quot;solid&quot;, color = red, label=&quot;Checksum\nMismatch&quot;];</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;       ProcessRxCommand-&gt;PARSE_STATE_SOM [arrowhead = &quot;normal&quot;, style = &quot;solid&quot;];</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;\enddot</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;### State machine state definitions:</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  1.  Search for Start of Message (SOM). This state will look for the &#39;$&#39; (HEX 24) character. When the SOM is found, then the only transition is to get the NMEA address field or what I call the command.</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  2.  Retrieve address field (command). The parser will collect characters until it encounters a &#39;,&#39; (comma HEX 2C) character. We are leaving the address field flexible length. This will allow parsing of any strange or proprietary sentences.</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  3.  Retrieve sentence data. This is where all of the data associated with the NMEA address is collected for further parsing. This state will continue to collect data and perform a checksum calculation until it receives a checksum delimiter &#39;*&#39; (HEX 2A) or sentence terminator &lt;CR&gt;&lt;LF&gt; (HEX 0D 0A).</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  4.  Receive first checksum ASCII character. This state simply waits for the first checksum character.</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  5.  Receive second checksum ASCII character. When the second checksum character is received, there should be enough information to verify the received checksum to the calculated checksum that was preformed in state 3. If the checksums match, then only other task to do is check for the sentence terminator.</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;When a complete NMEA command sentence is received, the virtual method CNMEAParserPacket::ProcessRxCommand() </div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;is called. This method is redefined in the CNMEAParser class and will parse the command, data, and stuff</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;them into the correct CNMESentence object.</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;#### Timeouts</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;Timeouts can be handled at a higher level. If for some reason data has not been received for a specified period of time, the software can reset the NMEA Parser by calling the CNMEAParserPacket::Reset() method.</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;## Source Code</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;NMEAParserLib is a C++ class library that will accept variable length data and parse a NMEA stream. Even though the code is written in C++, it only uses inherencies and virtual methods. </div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;## Features</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  - No outside library dependencies.</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  - OS independent (no OS specific calls)</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  - Abstract software synchronization. You can redefine the data lock virtual method to support your OS</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    specific semaphore or mutex functions.</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  - NMEA sentence notification. Redefine method to get notified that a new NMEA sentence was</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    processed.</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;## Required and Optional Tools</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  - cmake - Build environment. See https://cmake.org</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  - C++ 11 complaint compiler (Linux gcc or MS Windows VisualStudio)</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  - doxygen (for documentation, optional but recommended) - http://www.stack.nl/~dimitri/doxygen/</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  - graphviz (for documentation, optional but recommended) - http://graphviz.org/</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  - Qt 5.8 (optional) - https://www.qt.io/ Qt is a cross platform graphical interface tool that will allow you to build comprehensive GUI application.  The source code also includes a Qt project that uses the NMEAParser, displays position status, satellite azimuth/elevation, and signal quality graphically.</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;## Build</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  - Linux:</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   \code{.sh}</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      $ mkdir ./NMEAParserBuild</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      $ cd NMEAParserBuild</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      $ cmake ../Software</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      $ make</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      $ make doc</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   \endcode</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  - Windows:</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   \code{.sh}</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      [code was cloned to c:\Source\NMEAParser]</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;       c:\Source\NMEAParser&gt;mkdir ./NMEAParserBuild</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;       c:\Source\NMEAParser&gt;cd NMEAParserBuild</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;       c:\Source\NMEAParser\NMEAParserBuild&gt;cmake ../Software</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      [Run VisualStudio and build as normal]</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   \endcode</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;## Usage</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;Below is a basic program that defines a CNMEAParser object and streams NMEA data from a text</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;file.</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;\code{.cpp}</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   #include &lt;stdio.h&gt;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   #include &lt;NMEAParser.h&gt;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   ///</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   /// \class MyParser</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   /// \brief child class of CNMEAParser which will redefine notification calls from the parent class.</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   ///</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   class MyNMEAParser : public CNMEAParser {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;       ///</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;       /// \brief This method is called whenever there is a parsing error.</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;       ///</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;       /// Redefine this method to capture errors.</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;       ///</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;       /// \param pCmd Pointer to NMEA command that caused the error. Please note that this</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;       /// parameter may be NULL of not completely defined. Use with caution.</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;       ///</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;       virtual void OnError(CNMEAParserData::ERROR_E nError, char *pCmd) {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;           printf(&quot;ERROR for Cmd: %s, Number: %d\n&quot;, pCmd, nError);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;       }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   protected:</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;       ///</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;       /// \brief This method is redefined from CNMEAParserPacket::ProcessRxCommand(char *pCmd, char *pData)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;       ///</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;       /// \param pCmd Pointer to the NMEA command string</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;       /// \param pData Comma separated data that belongs to the command</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;       /// \return Returns CNMEAParserData::ERROR_OK If successful</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;       ///</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;       virtual CNMEAParserData::ERROR_E ProcessRxCommand(char *pCmd, char *pData) {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;           // Call base class to process the command</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;           CNMEAParser::ProcessRxCommand(pCmd, pData);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;           printf(&quot;Cmd: %s\nData: %s\n&quot;, pCmd, pData);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;           return CNMEAParserData::ERROR_OK;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;       }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   };</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   int main(int argc, char *argv[], char *envp[]) {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;       FILE *fp;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;       MyNMEAParser    NMEAParser;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;       //</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;       // Make sure that we have enough parameters</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;       //</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;       if (argc &lt; 2) {</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;           printf(&quot;Usage: NMEAParserTest [file]\n&quot;);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;           return -1;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;       }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;       //</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;       // Open the NMEA file, fail if cannot open</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;       //</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;       fp = fopen(argv[1], &quot;r&quot;);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;       if (fp == NULL) {</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;           printf(&quot;Could not open file: %s\n&quot;, argv[1]);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;           return -1;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;       }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;       //</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;       // Read the file and process</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;       //</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;       char pBuff[1024];</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;       while (feof(fp) == 0) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;           size_t nBytesRead = fread(pBuff, 1, 512, fp);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;           CNMEAParserData::ERROR_E nErr;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;           if ((nErr = NMEAParser.ProcessNMEABuffer(pBuff, nBytesRead)) != CNMEAParserData::ERROR_OK) {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;               printf(&quot;NMEA Parser ProcessNMEABuffer Failed and returned error: %d\n&quot;, nErr);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;               fclose(fp);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;               return -1;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;           }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;       }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;       fclose(fp);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;       return 0;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;\endcode</div></div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
